/*! moviq-build 2015-03-04 */
var moviqContainer=new Hilary;moviqContainer.register({name:"locale::en_US",factory:{errors:{interfaces:{requiresImplementation:"An implementation is required to create a new instance of an interface",requiresProperty:"The implementation is missing a required property: ",requiresArguments:"The implementation of this function requires the arguments: "},jqButtons:{fullscreenNotSupported:"Sorry, we don't recognize your browser, so we can't toggle fullscreen mode."}}}}),moviqContainer.register({name:"IButtons",dependencies:["locale"],factory:function(){"use strict";return function(a){var b=this,c=a||{};b.togglePlay=c.togglePlay,b.toggleFullscreen=c.toggleFullscreen,b.toggleCaptions=c.toggleCaptions,b.toggleMute=c.toggleMute,b.toggleQuality=c.toggleQuality,b.changeQuality=c.changeQuality,b.toggleSpeed=c.toggleSpeed,b.changeSpeed=c.changeSpeed,b.toggleMore=c.toggleMore}}}),moviqContainer.register({name:"IEventEmitter",dependencies:["locale"],factory:function(a){"use strict";return function(b){var c=this;if(!b)throw new Error(a.errors.interfaces.requiresImplementation);if("function"!=typeof b.emit)throw new Error(a.errors.interfaces.requiresProperty+"emit");if(2!==b.emit.length)throw new Error(a.errors.interfaces.requiresArguments+"type, data");c.emit=b.emit}}}),moviqContainer.register({name:"IEvents",dependencies:["locale"],factory:function(){"use strict";return function(a){var b=this,c=function(){};b.onLoadMetadata=a.onLoadMetadata||c,b.onTimeUpdate=a.onTimeUpdate||c,b.onCanPlay=a.onCanPlay||c,b.onCanPlayThrough=a.onCanPlayThrough||c,b.onVideoEnded=a.onVideoEnded||c,b.onSeeking=a.onSeeking||c,b.onSeekComplete=a.onSeekComplete||c,b.onWaiting=a.onWaiting||c,b.onError=a.onError||c,b.onPlay=a.onPlay||c,b.onPause=a.onPause||c,b.onShowCaptions=a.onShowCaptions||c,b.onHideCaptions=a.onHideCaptions||c,b.onToggleSpeed=a.onToggleSpeed||c,b.onChangeSpeed=a.onChangeSpeed||c,b.onToggleQuality=a.onToggleQuality||c,b.onChangeQuality=a.onChangeQuality||c,b.onSoundOn=a.onSoundOn||c,b.onSoundOff=a.onSoundOff||c,b.onFullscreenOn=a.onFullscreenOn||c,b.onFullscreenOff=a.onFullscreenOff||c}}}),moviqContainer.register({name:"IMoviq",dependencies:["locale","eventHandlers"],factory:function(a,b){"use strict";return function(c){var d=this,e=c||{};c||b.onError(a.errors.interfaces.requiresImplementation),"function"!=typeof e.bindTo&&b.onError(a.errors.interfaces.requiresProperty+"bindTo"),"function"!=typeof e.bindAll&&b.onError(a.errors.interfaces.requiresProperty+"bindAll"),d.bindTo=e.bindTo,d.bindAll=e.bindAll}}}),moviqContainer.register({name:"IProgressMeter",dependencies:["locale"],factory:function(a){"use strict";return function(b){var c=this,d=b||{};if(!b)throw new Error(a.errors.interfaces.requiresImplementation);if("function"!=typeof d.init)throw new Error(a.errors.interfaces.requiresProperty+"init");if(1!==b.init.length)throw new Error(a.errors.interfaces.requiresArguments+"iVideo");c.init=d.init}}}),moviqContainer.register({name:"ISource",dependencies:["locale","eventHandlers"],factory:function(a,b){"use strict";return function(c){var d=this;c||b.onError(a.errors.interfaces.requiresImplementation),"string"!=typeof c.src&&b.onError(a.errors.interfaces.requiresProperty+"src"),"string"!=typeof c.type&&b.onError(a.errors.interfaces.requiresProperty+"type"),"string"!=typeof c.label&&b.onError(a.errors.interfaces.requiresProperty+"label"),d.src=c.src,d.type=c.type,d.label=c.label}}}),moviqContainer.register({name:"ISourceParser",dependencies:["locale"],factory:function(a){"use strict";return function(b){var c=this,d=b||{};if(!b)throw new Error(a.errors.interfaces.requiresImplementation);if("function"!=typeof d.getSources)throw new Error(a.errors.interfaces.requiresProperty+"getSources");if(1!==d.getSources.length)throw new Error(a.errors.interfaces.requiresArguments+"iVideo");c.getSources=d.getSources}}}),moviqContainer.register({name:"ISourceManifestParser",dependencies:["locale"],factory:function(a){"use strict";return function(b){var c=this,d=b||{};if(!b)throw new Error(a.errors.interfaces.requiresImplementation);if("function"!=typeof d.getSourcesByManifest)throw new Error(a.errors.interfaces.requiresProperty+"getSourcesByManifest");if(1!==d.getSourcesByManifest.length)throw new Error(a.errors.interfaces.requiresArguments+"iVideo");c.getSourcesByManifest=d.getSourcesByManifest}}}),moviqContainer.register({name:"IVideo",dependencies:["locale"],factory:function(){"use strict";return function(a){var b=this,c=a||{};b.events=c.events,b.buttons=c.buttons,b.progress=c.progress,b.manifest=c.manifest,b.sources=c.sources,b.dom={handle:c.dom.handle,video:c.dom.video,controls:c.dom.controls,header:c.dom.header}}}}),moviqContainer.register({name:"IVideoInitializer",dependencies:["locale"],factory:function(a){"use strict";return function(b){var c=this,d=b||{};if(!b)throw new Error(a.errors.interfaces.requiresImplementation);if("function"!=typeof d.bindVideos)throw new Error(a.errors.interfaces.requiresProperty+"bindVideos");if(1!==d.bindVideos.length)throw new Error(a.errors.interfaces.requiresArguments+"querySelector");c.bindVideos=d.bindVideos}}}),moviqContainer.register({name:"consoleEventEmitter",dependencies:["locale","IEventEmitter"],factory:function(a,b){"use strict";return new b({emit:function(a,b){console.log("moviq-event",[a,b])}})}}),moviqContainer.register({name:"defaultEventHandlers",dependencies:["locale","eventEmitter"],factory:function(a,b){"use strict";var c={};return c.onError=function(a){throw b.emit("moviq-error",{message:a}),new Error(a)},c.onPlay=function(a){b.emit("moviq-play",{event:a})},c.onPause=function(a){b.emit("moviq-pause",{event:a})},c.onShowCaptions=function(a){b.emit("moviq-show-captions",{event:a})},c.onHideCaptions=function(a){b.emit("moviq-hide-captions",{event:a})},c.onToggleSpeed=function(a){b.emit("moviq-toggle-speed",{event:a})},c.onChangeSpeed=function(a,c){b.emit("moviq-change-speed",{speed:c,event:a})},c.onToggleQuality=function(a){b.emit("moviq-toggle-quality",{event:a})},c.onChangeQuality=function(a,c){b.emit("moviq-change-quality",{quality:a,event:c})},c.onSoundOn=function(a){b.emit("moviq-sound-on",{event:a})},c.onSoundOff=function(a){b.emit("moviq-sound-off",{event:a})},c.onFullscreenOn=function(a){b.emit("moviq-fullscreen-on",{event:a})},c.onFullscreenOff=function(a){b.emit("moviq-fullscreen-off",{event:a})},c}}),moviqContainer.register({name:"defaultHtmlTemplates",dependencies:["locale"],factory:function(){"use strict";var a;return a='<div class="moviq-controls"><div class="moviq-controls-enclosure"><div class="moviq-controls-left">    <button class="moviq-btn moviq-btn-play" title="Play/Pause video">        <span class="fa fa-play"></span>    </button></div><div class="moviq-progress">    <span class="moviq-progress-display"></span>    <span class="moviq-progress-picker"></span>    <div class="moviq-progress-bar">        <span class="moviq-progress-buffer"></span>        <span class="moviq-progress-time"></span>    </div></div><div class="moviq-controls-right">    <div class="moviq-dropdown">        <button class="moviq-btn moviq-dropdown-toggle" type="button" data-toggle="dropdown" title="Moviq Menu">            <span class="fa fa-cog"></span>        </button>        <ul class="moviq-dropdown-menu" role="menu">            <li role="presentation">                <button class="moviq-btn moviq-btn-cc" role="menuitem" tabindex="-1" title="Closed Captions">                    <i class="fa fa-cc"></i>                </button>            </li>            <li role="presentation">                <button class="moviq-btn moviq-btn-speed" role="menuitem" tabindex="-1" title="Playback Speed">                    <i class="fa fa-clock-o"></i>                </button>            </li>            <li role="presentation">                <button class="moviq-btn moviq-btn-quality" role="menuitem" tabindex="-1" title="Video Quality">                    <em>HD</em>                </button>            </li>        </ul>    </div>    <button class="moviq-btn moviq-btn-mute" title="Mute/Unmute sound">        <span class="fa fa-volume-off"></span>    </button>    <button class="moviq-btn moviq-btn-fullscreen" title="Switch to full screen">        <span class="fa fa-arrows-alt"></span>    </button></div></div></div>',{controls:a}}}),moviqContainer.register({name:"IJqVideo",dependencies:["locale","IVideo"],factory:function(a,b){"use strict";return function(a){var c=new b(a),d=a||{};return c.$dom={$handle:d.$dom.$handle,$video:d.$dom.$video,$controls:d.$dom.$controls,$header:d.$dom.$header},c}}}),moviqContainer.register({name:"jqButtons",dependencies:["locale","jqQuerySelectors"],factory:function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;return f=function(){var a=b.controls.getIconHandle(c,b.controls.play);return e.paused||e.ended?(a.removeClass("fa-play").addClass("fa-pause"),e.play(),1):(a.removeClass("fa-pause").addClass("fa-play"),e.pause(),0)},i=function(){var a=c.$dom.$handle;return a.hasClass("fullscreen")?(k(c),0):(j(c),1)},j=function(){var d=c.dom.handle,e=c.$dom.$handle,f=b.controls.getIconHandle(c,b.controls.fullscreen);d.requestFullscreen?d.requestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen?d.webkitRequestFullscreen():c.events.onError(a.errors.jqButtons.fullscreenNotSupported),e.addClass("fullscreen"),f.removeClass("fa-arrows-alt").addClass("fa-compress")},k=function(){var a=c.$dom.$handle,d=b.controls.getIconHandle(c,b.controls.fullscreen);a.removeClass("fullscreen"),d.removeClass("fa-compress").addClass("fa-arrows-alt"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},g=function(){var a=b.controls.getHandle(c,b.controls.cc),d=e.textTracks[0];if(a.hasClass("selected")){if(a.removeClass("selected"),d)return d.mode="hidden",0}else if(a.addClass("selected"),d)return d.mode="showing",1},l=function(){var a=b.controls.getIconHandle(c,b.controls.mute);return e.muted=!e.muted,a.hasClass("fa-volume-off")?(a.removeClass("fa-volume-off").addClass("fa-volume-up"),0):(a.removeClass("fa-volume-up").addClass("fa-volume-off"),1)},m=function(){var a=b.controls.getHandle(c,b.controls.speed);o(a,"with-speed")},n=function(a){if("number"==typeof a){var b=a.toFixed(2),c=e.playbackRate.toFixed(2);return b!==c?(e.playbackRate=a,{newSpeed:b,changed:!0}):{newSpeed:b,changed:!1}}if("string"!=typeof a)return{newSpeed:e.playbackRate.toFixed(2),changed:!1};try{return n(parseFloat(a))}catch(d){return e.playbackRate}},p=function(){var a=b.controls.getHandle(c,b.controls.quality);o(a,"with-quality")},o=function(a,d){if(a.hasClass("selected"))a.removeClass("selected"),c.$dom.$controls.removeClass(d);else{var e;for(b.controls.getHandle(c,".selected").removeClass("selected"),e=0;e<b.controls.subMenus.length;e+=1)c.$dom.$controls.removeClass(b.controls.subMenus[e]);a.addClass("selected"),c.$dom.$controls.addClass(d)}},h=function(){return{play:!0,volume:!0,fullscreen:!0,speed:!0,cc:e.textTracks.length>0,quality:e.moviq.sources.count>1}},r=function(a){var d=b.controls.getHandle(c,b.controls.play),e=b.controls.getHandle(c,b.controls.cc),f=b.controls.getHandle(c,b.controls.speed),g=b.controls.getHandle(c,b.controls.quality),h=b.controls.getHandle(c,b.controls.mute),i=b.controls.getHandle(c,b.controls.fullscreen),j=b.controls.getHandle(c,b.controls.speed_chooser),k=b.controls.getHandle(c,b.controls.speed_current);c.$dom.$handle.on("mouseenter",function(){c.$dom.$controls.stop().fadeTo(500,.9),c.$dom.$header.stop().fadeTo(500,.9)}).on("mouseleave",function(){c.$dom.$controls.stop().fadeOut(),c.$dom.$header.stop().fadeOut()}),d.on("click",function(b){var d=a.togglePlay();1===d?c.events.onPlay(b):0===d&&c.events.onPause(b)}),e.on("click",function(b){var d=a.toggleCaptions();1===d?c.events.onShowCaptions(b):0===d&&c.events.onHideCaptions(b)}),f.on("click",function(b){a.toggleSpeed();c.events.onToggleSpeed(b)}),j.on("change mousemove",function(b){var d=a.changeSpeed(j.val());k.text(j.val()+"x"),d.changed&&c.events.onChangeSpeed(b,d.newSpeed)}),g.on("click",function(b){a.toggleQuality();c.events.onToggleQuality(b)}),h.on("click",function(b){var d=a.toggleMute();1===d?c.events.onSoundOn(b):0===d&&c.events.onSoundOff(b)}),i.on("click",function(b){var d=a.toggleFullscreen();1===d?c.events.onFullscreenOn(b):0===d&&c.events.onFullscreenOff(b)})},q=function(a){var b;return c=a,d=c.$dom.$video,e=c.dom.video,b={togglePlay:f,toggleCaptions:g,toggleFullscreen:i,toggleMute:l,toggleSpeed:m,changeSpeed:n,toggleQuality:p,buttonsToShow:h},r(b),b},{init:q}}}),moviqContainer.register({name:"jqEventEmitter",dependencies:["locale","IEventEmitter","jQuery"],factory:function(a,b,c){"use strict";return new b({emit:function(a,b){c(document).trigger(a,[b]).trigger("moviq-event",[a,b])}})}}),moviqContainer.register({name:"jqProgressMeter",dependencies:["locale","jqQuerySelectors","IProgressMeter"],factory:function(a,b,c){"use strict";var d=function(a){var c,d,e,f,g,h,i,j,k,l,m=a,n=!1;c=m.$dom.$video,d=m.dom.video,e=b.controls.getHandle(m,b.controls.progress_bar),f=b.controls.getHandle(m,b.controls.progress_time),g=b.controls.getHandle(m,b.controls.progress_buffer),h=b.controls.getHandle(m,b.controls.progress_timeDisplay),k={getPositionPercent:function(){return 100*(d.currentTime/d.duration)},getBufferedPercent:function(){return d.buffered.length>0?100*(d.buffered.end(0)/d.duration):0},getAmountConsumed:function(){throw new Error("NOT IMPLEMENTED")}},l={setPosition:function(a){var b=l.getCoordinates(a).percent;l.updateDisplay(b),d.currentTime=d.duration*b/100},getCoordinates:function(a){var b=a-e.offset().left,c=100*b/e.width();return c>100?c=100:0>c&&(c=0),{position:b,percent:c}},getPosition:function(a){var b=l.getCoordinates(a),c=d.duration*(b.percent/100);return{time:j(c),left:b.position}},updateDisplay:function(a){var b=a||k.getPositionPercent(),c=k.getBufferedPercent(),e=j(d.currentTime);d.duration>0&&(e+=" / "+j(d.duration)),f.css("width",b+"%"),g.css("width",c+"%"),n||h.text(e)}},j=function(a){var b,c;return b=Math.floor(a/60)<10?"0"+Math.floor(a/60):Math.floor(a/60),c=Math.floor(a-60*b)<10?"0"+Math.floor(a-60*b):Math.floor(a-60*b),b+":"+c},i=function(){var a=b.controls.getHandle(m,b.controls.progress_timeDisplay),d=b.controls.getHandle(m,b.controls.progress_timePicker);c.on("timeupdate",function(){l.updateDisplay()}),e.on("mousedown",function(a){l.setPosition(a.pageX)}).on("mouseleave",function(){d.text(""),n=!1}).on("mousemove",function(b){var c=l.getPosition(b.pageX);n=!0,a.text(""),d.text(c.time),d.css("left",c.left)})},i(),l.updateDisplay()};return new c({init:d})}}),moviqContainer.register({name:"jqQuerySelectors",factory:{header:".moviq-header",controls:{control_container:".moviq-controls",more_controls_container:".moviq-controls-enclosure-more",play:".moviq-btn-play",mute:".moviq-btn-mute",fullscreen:".moviq-btn-fullscreen",cc:".moviq-btn-cc",choose_cc:".moviq-btn-choose-cc",speed:".moviq-btn-speed",speed_chooser:".moviq-speed-chooser",speed_current:".moviq-current-speed",choose_speed:".moviq-btn-choose-speed",quality:".moviq-btn-quality",choose_quality:".moviq-btn-choose-quality",progress:".moviq-progress",progress_bar:".moviq-progress-bar",progress_buffer:".moviq-progress-buffer",progress_time:".moviq-progress-time",progress_timeDisplay:".moviq-progress-display",progress_timePicker:".moviq-progress-picker",buttons_right:".moviq-buttons-right",controls_left:".moviq-controls-left",controls_right:".moviq-controls-right",subMenus:["with-speed","with-quality","with-cc"],getHandle:function(a,b){return a.$dom.$controls.find(b)},getIconHandle:function(a,b){return a.$dom.$controls.find(b+" span")}}}}),moviqContainer.register({name:"jqSourceParser",dependencies:["locale","ISource","ISourceParser","jQuery"],factory:function(a,b,c,d){"use strict";var e,f;return f=function(a){var b,c,f=[],g=e(a.$dom.$video),h=a.$dom.$video.children("source");for(g&&f.push(g),c=0;c<h.length;c+=1)b=e(d(h[c]),c),b&&f.push(b);return f},e=function(a,c){var d=a.attr("src"),e=a.attr("type"),f=a.attr("data-label");return d&&e?new b({src:d,type:e,label:f||"Q"+((c||0)+1).toString()}):null},new c({getSources:f})}}),moviqContainer.register({name:"jqVideo",dependencies:["locale","IJqVideo","jqQuerySelectors","eventHandlers","jqButtons","jqProgressMeter","sourceParser","sourceManifestParser","htmlTemplates"],factory:function(a,b,c,d,e,f,g,h,i){"use strict";return function(a){var j,k,l=a.find(c.controls.control_container);j=new b({events:d,$dom:{$handle:a,$video:a.children("video").first(),$controls:a.children(c.controls.control_container).first(),$header:a.children(c.header).first()},dom:{handle:a[0],video:a.children("video").first()[0],controls:a.children(c.controls.control_container).first()[0],header:a.children(c.header).first()[0]}}),l.length<1&&j.$dom.$handle.append(i.controls),j.buttons=e.init(j),j.progress=f.init(j),j.manifest=j.dom.video.dataset.manifest,j.sources=j.manifest?h.getSourcesByManifest(j):g.getSources(j),k=j.dom.video.textTracks[0],k&&(k.mode="hidden"),a.addClass("moviqified")}}}),moviqContainer.register({name:"jqVideoInitializer",dependencies:["locale","Video","IVideoInitializer","eventEmitter","jQuery"],factory:function(a,b,c,d,e){"use strict";return new c({bindVideos:function(c){var f,g,h=[],i=".moviqified";for(c?"string"==typeof c?f=e(e(c).not(i)):c instanceof e&&(f=c.not(i)):f=e(".moviq-video").not(i),0===f.length&&console.log("moviq info","no videos were found to process"),g=0;g<f.length;g+=1)h.push(new b(e(f[g]),d,a));return h}})}}),function(a){"use strict";var b;b=function(a){var b,c,d,e,f,g,h,i;a.register({name:"locale",factory:function(){return b||(b=a.resolve("locale::en_US")),b}}),a.register({name:"eventEmitter",factory:function(){return c||(c=a.resolve("jqEventEmitter")),c}}),a.register({name:"eventHandlers",factory:function(){return g||(g=a.resolve("defaultEventHandlers")),g}}),a.register({name:"sourceParser",factory:function(){return d||(d=a.resolve("jqSourceParser")),d}}),a.register({name:"sourceManifestParser",factory:function(){return e||(e="NOT IMPLEMENTED"),e}}),a.register({name:"htmlTemplates",factory:function(){return f||(f=a.resolve("defaultHtmlTemplates")),f}}),a.register({name:"Video",factory:function(){return h||(h=a.resolve("jqVideo")),h}}),a.register({name:"videoInitializer",factory:function(){return i||(i=a.resolve("jqVideoInitializer")),i}})},a.Moviq=function(a){var c,d,e,f=moviqContainer,g=a||{};return b(f),c=f.resolve("IMoviq"),d=f.resolve("videoInitializer"),e=new c({bindTo:d.bindVideos,bindAll:d.bindVideos}),g.bindNow&&e.bindAll(),e}}(window);